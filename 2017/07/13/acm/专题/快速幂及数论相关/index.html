<!doctype html>




<html class="theme-next pisces" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="special,n-t," />




  


  <link rel="alternate" href="/atom.xml" title="oodt's blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.1" />






<meta name="description" content="这里讲一下目前做的两道快速幂吧    快速幂的题我是不好的，因为从一开始就不知道这东西，感觉总是记不住，一定要多看。    快速幂的东西也挺多的    主要是展开出来的不会的东西太多了">
<meta property="og:type" content="article">
<meta property="og:title" content="快速幂及数论相关">
<meta property="og:url" content="http://oodtoodt.github.io/2017/07/13/acm/%E4%B8%93%E9%A2%98/%E5%BF%AB%E9%80%9F%E5%B9%82%E5%8F%8A%E6%95%B0%E8%AE%BA%E7%9B%B8%E5%85%B3/index.html">
<meta property="og:site_name" content="oodt&#39;s blog">
<meta property="og:description" content="这里讲一下目前做的两道快速幂吧    快速幂的题我是不好的，因为从一开始就不知道这东西，感觉总是记不住，一定要多看。    快速幂的东西也挺多的    主要是展开出来的不会的东西太多了">
<meta property="article:published_time" content="2017-07-13T02:41:00.000Z">
<meta property="article:modified_time" content="2020-07-14T02:03:37.000Z">
<meta property="article:author" content="eco_oodt">
<meta property="article:tag" content="special">
<meta property="article:tag" content="n-t">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://oodtoodt.github.io/2017/07/13/acm/专题/快速幂及数论相关/"/>





  <title>快速幂及数论相关 | oodt's blog</title>
  














<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">oodt's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">自杀之路</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://oodtoodt.github.io/2017/07/13/acm/%E4%B8%93%E9%A2%98/%E5%BF%AB%E9%80%9F%E5%B9%82%E5%8F%8A%E6%95%B0%E8%AE%BA%E7%9B%B8%E5%85%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eco_oodt">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/prpr.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="oodt's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">快速幂及数论相关</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-13T10:41:00+08:00">
                2017-07-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/acm/" itemprop="url" rel="index">
                    <span itemprop="name">acm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/07/13/acm/%E4%B8%93%E9%A2%98/%E5%BF%AB%E9%80%9F%E5%B9%82%E5%8F%8A%E6%95%B0%E8%AE%BA%E7%9B%B8%E5%85%B3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/07/13/acm/专题/快速幂及数论相关/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/07/13/acm/%E4%B8%93%E9%A2%98/%E5%BF%AB%E9%80%9F%E5%B9%82%E5%8F%8A%E6%95%B0%E8%AE%BA%E7%9B%B8%E5%85%B3/" class="leancloud_visitors" data-flag-title="快速幂及数论相关">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这里讲一下目前做的两道快速幂吧<br>    快速幂的题我是不好的，因为从一开始就不知道这东西，感觉总是记不住，一定要多看。<br>    快速幂的东西也挺多的<br>    主要是展开出来的不会的东西太多了</p>
<a id="more"></a>

<hr>
<h3 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h3><p>模版</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">qk_pow</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b) &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * a) % p;</span><br><span class="line">        a = (a*a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="组合数取模。"><a href="#组合数取模。" class="headerlink" title="组合数取模。"></a>组合数取模。</h4><blockquote>
<p>对于C(n, m) mod p。这里的n，m，p（p为素数）都很大的情况。就不能再用C(n, m) = C(n - 1，m) + C(n - 1, m - 1)的公式递推了。<br>然后用lucas定理</p>
</blockquote>
<h5 id="lucas："><a href="#lucas：" class="headerlink" title="lucas："></a>lucas：</h5><p>$$<br>\begin{pmatrix}<br>m\\n<br>\end{pmatrix}<br>=<br>\prod_{i=0}^k<br>\begin{pmatrix}<br>m_i\\n_i<br>\end{pmatrix}<br>(mod \  p)<br>$$</p>
<p> 对于单独的$C^{ni}_{mi}( mod \ p)​$，已知$C^n_m (mod \ p) = \frac{n!}{m!(n - m)!} (mod \ p)​$。显然除法取模，这里要用到$m!(n-m)!​$的逆元。</p>
<p>根据费马小定理，已知(a, p) = 1，则 $ a^{p-1} ≡ 1 (mod \ p) $,  所以 $ a*a^{p-2} ≡ 1 (mod \ p) $。<br>也就是 $(m!(n-m)!)$的逆元为 $(m!(n-m)!)^{p-2}$</p>
<p>这里讲一下逆元（虽然大概用不到，不过我觉得还是理解一下比较好，免得只会做模版题）</p>
<blockquote>
<p>在求解除法取模问题(a/b)%m时，我们可以转化为a%(b∗m)/b， 但是如果b很大，则会出现爆精度问题，所以我们避免使用除法直接计算。<br>可以使用逆元将除法转换为乘法： 假设b存在乘法逆元，即与m互质（充要条件）。设c是b的逆元，即b∗c≡1(mod m)，那么有$$a/b=(a/b)∗1=(a/b)∗b∗c=a∗c(mod m) $$<br>即，除以一个数取模等于乘以这个数的逆元取模。</p>
<ol>
<li>逆元求解一般利用扩欧。</li>
<li>当m为质数的时候直接使用费马小定理，m非质数使用欧拉函数。</li>
<li>当m为质数的时候，神奇的线性方法。</li>
</ol>
</blockquote>
<p>心血来潮讲一下扩欧好了。<br>以下数论：</p>
<h4 id="欧几里得gcd，每次都能忘的东西："><a href="#欧几里得gcd，每次都能忘的东西：" class="headerlink" title="欧几里得gcd，每次都能忘的东西："></a>欧几里得gcd，每次都能忘的东西：</h4><p>时间复杂度：O(log(a+b))<br>扩欧同</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? gcd(b, a % b) : a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="扩展欧几里得算法（数学爆炸，一点都不想看）自己看去吧"><a href="#扩展欧几里得算法（数学爆炸，一点都不想看）自己看去吧" class="headerlink" title="扩展欧几里得算法（数学爆炸，一点都不想看）自己看去吧"></a>扩展欧几里得算法（数学爆炸，一点都不想看）<a href="https://www.zybuluo.com/samzhang/note/541890" target="_blank" rel="noopener">自己看去吧</a></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">extgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> d = a;</span><br><span class="line">  <span class="keyword">if</span>(b != <span class="number">0</span>) &#123;</span><br><span class="line">      d  = extgcd(b, a % b, y, x);</span><br><span class="line">      y -= (a/b) * x;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">      x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>扩展欧几里德算法的应用主要有以下三方面：</p>
<ol>
<li>求解不定方程；<br>对于不定整数方程pa+qb=c(ax+by = c)，若 c % gcd(p, q)=0,则该方程存在整数解，否则不存在整数解。<br>假设d=gcd(a,b). 那 么x=x0+b/d<em>t; y=y0-a/d</em>t;其中t为任意常整数<br>注意：若b为负数，需将b转换为正数。（好像a，b都不能为负#存疑）<h5 id="模版题-hdu2669"><a href="#模版题-hdu2669" class="headerlink" title="模版题 hdu2669"></a>模版题 hdu2669</h5>求是否存在使给出的ab，ax+by = 1的xy。存在给出最小的。<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">extgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d = a;</span><br><span class="line">    <span class="keyword">if</span>(b != <span class="number">0</span>) &#123;</span><br><span class="line">        d  = extgcd(b, a % b, y, x);</span><br><span class="line">        y -= (a/b) * x;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/hdu2669.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x,y;</span><br><span class="line">        <span class="keyword">int</span> d = extgcd(n,m,x,y);</span><br><span class="line">        <span class="keyword">if</span>(d == <span class="number">1</span>)<span class="comment">//if c % d==0 则原方程有解，这里是1%d==0，所以d==1 其实应该写成 if(1%d == 0)或是if(!(c%d))</span></span><br><span class="line">        &#123;</span><br><span class="line">            x *= c/d;</span><br><span class="line">            y *= c/d;</span><br><span class="line">            <span class="keyword">while</span>(x&lt;=<span class="number">0</span>)&#123;</span><br><span class="line">                x += m;<span class="comment">//实为x += m/d;</span></span><br><span class="line">                y -= n;<span class="comment">//实为y -= n/d;</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,x,y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"sorry\n"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
d是a,b的最大公因数。<h5 id="poj1061"><a href="#poj1061" class="headerlink" title="poj1061"></a>poj1061</h5>a从x开始一次跳m，b从y开始一次跳n，绕l长的地球纬线跳求跳几次相遇。<br>化方程为$(m-n)c+lt = y-x$的扩欧形式，然后代模版。<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">extgcd</span><span class="params">(ll a, ll b, ll &amp;x, ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ll d = a;</span><br><span class="line">    <span class="keyword">if</span>(b != <span class="number">0</span>) &#123;</span><br><span class="line">        d  = extgcd(b, a % b, y, x);</span><br><span class="line">        y -= (a/b) * x;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/poj1061.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    ll x,y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld%lld"</span>,&amp;x,&amp;y,&amp;m,&amp;n,&amp;l);</span><br><span class="line">    ll c,t;</span><br><span class="line">    ll p = x - y;</span><br><span class="line">    ll a = n - m;</span><br><span class="line">    ll b = l;</span><br><span class="line">    ll d = extgcd(a,b,x,y);</span><br><span class="line">    <span class="keyword">if</span>(!(p % d))</span><br><span class="line">    &#123;</span><br><span class="line">        x *= p/d;</span><br><span class="line">        ll s = b/d;</span><br><span class="line">        x = (x % s + s) % s;<span class="comment">//这里可以先x%s，然后while(x&lt;=0)x+=s;</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Impossible\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="hdu1576"><a href="#hdu1576" class="headerlink" title="hdu1576"></a>hdu1576</h5>求(A/B)%9973,给出n=A%9973,gcd(B,9973)=1,且A一定被B整除。<br>A = Bx，A = 9973y + n.Bx - 9973y= n.代模版。</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">extgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d = a;</span><br><span class="line">    <span class="keyword">if</span>(b)</span><br><span class="line">    &#123;</span><br><span class="line">        d = extgcd(b,a%b,y,x);</span><br><span class="line">        y -= (a/b) * x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        x = <span class="number">1</span>;</span><br><span class="line">        y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/hdu1576.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> q;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;q);</span><br><span class="line">    <span class="keyword">int</span> b;</span><br><span class="line">    <span class="keyword">int</span> x,y;</span><br><span class="line">    <span class="keyword">while</span>(q--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;b);</span><br><span class="line">        extgcd(b,<span class="number">9973</span>,x,y);</span><br><span class="line">        x *= n;</span><br><span class="line">        <span class="keyword">int</span> s = <span class="number">9973</span>;</span><br><span class="line"><span class="comment">//        x = (x%s+s)%s;</span></span><br><span class="line">        x = x % s;</span><br><span class="line">        <span class="keyword">while</span>(x &lt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            x += s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="poj2142"><a href="#poj2142" class="headerlink" title="poj2142"></a>poj2142</h5><p>x个a的砝码和y个b的砝码去称d的东西。问ax+by最小且a+b最小的值。<br>可以化成$a(x1-x2)+b(y1-y2) = d$。要求x1+x2，y1+y2，则必有其中x2,y2=0，所以直接就是$ax+by=d$的扩欧形式，求出最小整数解。由于y有时求出来为负数，因为砝码放在左边右边的缘故可以换成正数。然后解出最小x求出y，解出最小y求出x，一比较即可，不多说，上代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? gcd(b,a%b) : a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">extgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d = a;</span><br><span class="line">    <span class="keyword">if</span>(b != <span class="number">0</span>) &#123;</span><br><span class="line">        d  = extgcd(b, a % b, y, x);</span><br><span class="line">        y -= (a/b) * x;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/poj2142.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> A,B,D;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;A,&amp;B,&amp;D) &amp;&amp; (A+B+D))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> x1,x2,y1,y2;</span><br><span class="line">        <span class="keyword">int</span> d1 = extgcd(A,B,x1,y1);</span><br><span class="line">        x1 *= D/d1;</span><br><span class="line">        <span class="keyword">int</span> s = B/d1;</span><br><span class="line">        x1 = (x1 % s + s) % s;</span><br><span class="line">        y1 = (D - A*x1)/B;</span><br><span class="line">        <span class="keyword">if</span>(y1 &lt; <span class="number">0</span>) y1 *= <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> d2 = extgcd(A,B,x2,y2);<span class="comment">//这里分d1d2其实是废的。因为gcd根本就是一样的</span></span><br><span class="line">        y2 *= D/d2;</span><br><span class="line">        s = A/d2;</span><br><span class="line">        y2 = (y2 % s + s) % s;</span><br><span class="line">        x2 = (D - B*y2)/A;</span><br><span class="line">        <span class="keyword">if</span>(x2 &lt; <span class="number">0</span>) x2 *= <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(x1+y1 &lt; x2+y2)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,x1,y1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%d %d\n"</span>,x2,y2);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ol start="2">
<li>求解模线性方程（线性同余方程）；<blockquote>
<p>同余方程 ax≡b (mod n)对于未知数 x 有解，当且仅当 gcd(a,n) | b。且方程有解时，方程有 gcd(a,n) 个解。<br>求解方程 ax≡b (mod n) 相当于求解方程 ax+ ny= b, (x, y为整数)<br>可以求得ans=x*(b/d),s=n/d，d是extcd。<br>方程ax≡b (mod n)的最小整数解为：(ans%s+s)%s;</p>
</blockquote>
</li>
</ol>
<p>我觉得这个也适用到1中求最小整数解。<br>求x的就是(x%s+s)%s，s=b/d;<br>3. 求解模的逆元；<br>   逆元题头已讲。<br>   看几道逆元的题吧。</p>
<h5 id="hdu1576、poj2115、poj2142、"><a href="#hdu1576、poj2115、poj2142、" class="headerlink" title="hdu1576、poj2115、poj2142、"></a>hdu1576、poj2115、poj2142、</h5><p>。。。所以说跟扩欧的题其实有一定的关系</p>
<h5 id="hdu1211"><a href="#hdu1211" class="headerlink" title="hdu1211"></a>hdu1211</h5><p>rsa 给大质数p,q以及整数e.n = p<em>q,f = (p-1)</em>(q-1) 给出密码的ascii加密后的数字c，求$c^d\ mod \ n$其中 $ d * e\ mod \ f =1$<br>重点就是求d。直接扩欧。起初没想到直接暴力就可以做的。d不大。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">qk_pow</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b) &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * a) % p;</span><br><span class="line">        a = (a*a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">extgcd</span><span class="params">(LL a, LL b, LL &amp;x, LL &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL d = a;</span><br><span class="line">    <span class="keyword">if</span>(b != <span class="number">0</span>) &#123;</span><br><span class="line">        d  = extgcd(b, a % b, y, x);</span><br><span class="line">        y -= (a/b) * x;</span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        x = <span class="number">1</span>, y = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/rsa/hdu1211.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    LL p,q,e,l,x,y;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld%lld"</span>,&amp;p,&amp;q,&amp;e,&amp;l))</span><br><span class="line">    &#123;</span><br><span class="line">        n = p * q;</span><br><span class="line">        LL F = (p<span class="number">-1</span>)*(q<span class="number">-1</span>);</span><br><span class="line">        LL D = extgcd(e,F,x,y);</span><br><span class="line"><span class="comment">//x *= /D;</span></span><br><span class="line">        LL s = F/D;</span><br><span class="line">        x = (x % s + s) % s;</span><br><span class="line"><span class="comment">//        printf("%lld",x);</span></span><br><span class="line">        <span class="keyword">for</span>(LL i = <span class="number">0</span>; i &lt; l; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            LL c;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;c);</span><br><span class="line">            c = qk_pow(c,x,n);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%c"</span>,c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="hdu5407"><a href="#hdu5407" class="headerlink" title="hdu5407"></a>hdu5407</h5><h5 id="cf-300c"><a href="#cf-300c" class="headerlink" title="cf 300c"></a>cf 300c</h5><p><a href="https://cn.vjudge.net/problem/CodeForces-300C" target="_blank" rel="noopener">题点这里</a><br>给出a,b，有个sb非要叫只含a,b的数为good，叫所有位上的数相加之和为good数的数excellent。求指定位数的数字有多少个ex数，答案模10^9+7。<br>ax+by=t… x+y=n枚举x从1-n，然后检查t是否符合，符合则ans+=$C_n^i$。然后就变成了一个组合数取模的题了。</p>
<h4 id="组合数取模。-1"><a href="#组合数取模。-1" class="headerlink" title="组合数取模。"></a>组合数取模。</h4><blockquote>
<p>根据费马小定理：<br>已知(a, p) = 1，则 $a^{p-1} ≡ 1 (mod p)$,  所以 $a*a^{p-2} ≡ 1 (mod p)$。</p>
</blockquote>
<p>一般来说可以直接用费马做，因为p一般为质数。<br>贴两道题。</p>
<h5 id="cf300c"><a href="#cf300c" class="headerlink" title="cf300c"></a>cf300c</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">qk_pow</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b) &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * a) % p;</span><br><span class="line">        a = (a*a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Comb</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a &lt; b)   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(a == b)  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(b &gt; a - b)   b = a - b;</span><br><span class="line"></span><br><span class="line">    LL ans = <span class="number">1</span>, ca = <span class="number">1</span>, cb = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(LL i = <span class="number">0</span>; i &lt; b; ++i) &#123;</span><br><span class="line">        ca = (ca * (a - i))%p;</span><br><span class="line">        cb = (cb * (b - i))%p;</span><br><span class="line">    &#125;</span><br><span class="line">    ans = (ca*qk_pow(cb, p - <span class="number">2</span>, p)) % p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">Lucas</span><span class="params">(LL n, LL m, LL p)</span> </span>&#123;</span><br><span class="line">    LL ans = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(n&amp;&amp;m&amp;&amp;ans) &#123;</span><br><span class="line">        ans = (ans*Comb(n%p, m%p, p)) % p;</span><br><span class="line">        n /= p;</span><br><span class="line">        m /= p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">check</span><span class="params">(LL t,LL a,LL b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL q = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(t &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        q = t%<span class="number">10</span>;</span><br><span class="line">        <span class="keyword">if</span>(!(q == a || q == b))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        t /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> LL p = <span class="number">1000000007</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/rsa/cf300c.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    LL a,b,n,A,B;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%lld%lld%lld"</span>,&amp;A,&amp;B,&amp;n);</span><br><span class="line">    a = B - A;</span><br><span class="line">    b = A;</span><br><span class="line">    LL t;</span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(LL i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        t = a*i + b*n;</span><br><span class="line">        <span class="keyword">if</span>(check(t,A,B))</span><br><span class="line">        &#123;</span><br><span class="line">            ans = (ans + Comb(n,i,p)) % p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="cf327c"><a href="#cf327c" class="headerlink" title="cf327c"></a>cf327c</h5><p><a href="https://cn.vjudge.net/problem/CodeForces-327C" target="_blank" rel="noopener">题点这里</a><br>有k个一样的长n的数字串串起来，要求删掉一些数字使得它可以被5整除。答案模10^9+7<br>容易知道是a[i] 为5或0时$\sum_{j=0}^{j = k}$ $2^{i+j\cdot n-n} $<br>然而会tle。<br>这时当成等比数列进行处理，p = 2^n;求和$s = \frac {2^i - 2^{i+k\cdot n}}{1-p}$<br>然后逆元。$s = 分子\cdot (1-p)^{模-2}$<br>分子里的$2^i$ 可以提出来当作乘数累算<br>注意在算s的时候会爆精….哪怕模了也爆…(废话)…<br>算模如果想取正可以  (a % p + p ) % p</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">qk_pow</span><span class="params">(LL a, LL b, LL p)</span> </span>&#123;</span><br><span class="line">    LL res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(b) &#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res = (res * a) % p;</span><br><span class="line">        a = (a*a) % p;</span><br><span class="line">        b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/rsa/cf327c.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s%d"</span>,a,&amp;k);</span><br><span class="line"><span class="comment">//    printf("%s,%d",a,k);</span></span><br><span class="line">    l = <span class="built_in">strlen</span>(a);</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    LL d = qk_pow(<span class="number">2</span>,l,p);</span><br><span class="line">    LL y,z,x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; l; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i] == <span class="string">'5'</span> || a[i] == <span class="string">'0'</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            x = qk_pow(<span class="number">2</span>,i,p);</span><br><span class="line">            cnt += x,cnt %= p;</span><br><span class="line">            <span class="comment">//   printf("%lld\n",ans);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    y = qk_pow(d,k,p);</span><br><span class="line">    y = <span class="number">1</span>-y;</span><br><span class="line"><span class="comment">//    y = ((1 - y) % p + p) % p;</span></span><br><span class="line"><span class="comment">//    z = ((1-d)% p + p) % p;直接用负数也可以。</span></span><br><span class="line"><span class="comment">//    printf("%d\n",z);</span></span><br><span class="line">    z = qk_pow(<span class="number">1</span>-d,p<span class="number">-2</span>,p);</span><br><span class="line">    ans = (cnt * ((y * z) % p)) % p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数:"></a>欧拉函数:</h4><blockquote>
<p>根据欧拉函数:<br>令ϕ(m)表示小于等于m且与m互素的正整数的个数。<br>如果x和m互质，则有$x^{ϕ(m)}≡1(mod\ m)$，即$x×x^{ϕ(m)−1}≡1(mod\ m)$，$x^{ϕ(m)−1}$即为x的逆元。 </p>
</blockquote>
<p>以下模版<br>筛法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> euler[<span class="number">3000001</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getEuler</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(euler,<span class="number">0</span>,<span class="keyword">sizeof</span>(euler));</span><br><span class="line">	euler[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= <span class="number">3000000</span>;i++)</span><br><span class="line">		<span class="keyword">if</span>(!euler[i])</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j = i;j &lt;= <span class="number">3000000</span>; j += i)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(!euler[j])</span><br><span class="line">                	euler[j] = j;</span><br><span class="line">                euler[j] = euler[j]/i*(i<span class="number">-1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>单个数欧拉函数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">eular</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i*i &lt;= n;i++) </span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">    		ans -= ans/i; </span><br><span class="line">    		<span class="keyword">while</span>(n % i == <span class="number">0</span>)</span><br><span class="line">  				n /= i; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">1</span>)ans -= ans/n;</span><br><span class="line">  	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>线性筛（同时得到欧拉函数和素数表）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10000000</span>; <span class="keyword">bool</span> check[MAXN+<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> phi[MAXN+<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> prime[MAXN+<span class="number">10</span>];</span><br><span class="line"><span class="keyword">int</span> tot;<span class="comment">//素数的个数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">phi_and_prime_table</span><span class="params">(<span class="keyword">int</span> N)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>( check ,<span class="literal">false</span>,<span class="keyword">sizeof</span>( check ));</span><br><span class="line">    phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    tot = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= N; i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">if</span>( !check[i] )</span><br><span class="line">   		&#123;</span><br><span class="line">    		prime[tot++] = i; </span><br><span class="line">    		phi[i] = i<span class="number">-1</span>;</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; tot; j++) </span><br><span class="line">    	&#123;</span><br><span class="line">            <span class="keyword">if</span>(i * prime[j] &gt; N)<span class="keyword">break</span>; </span><br><span class="line">            check[i * prime[j]] = <span class="literal">true</span>; </span><br><span class="line">            <span class="keyword">if</span>( i % prime[j] == <span class="number">0</span>)</span><br><span class="line">  			&#123;</span><br><span class="line">    			phi[i * prime[j]] = phi[i] * prime[j];</span><br><span class="line">    			<span class="keyword">break</span>; </span><br><span class="line">    		&#125;</span><br><span class="line">    		<span class="keyword">else</span></span><br><span class="line">   			&#123;</span><br><span class="line">   				phi[i * prime[j]] = phi[i] * (prime[j] - <span class="number">1</span>);</span><br><span class="line">        	&#125; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<hr>
<p>另，1～n比n小且与n互素数之和为 $ s(n) = n \cdot phi(n) /2$<br>因为有gcd(n,i)=1 then gcd(n,n-i)=1，i与n-i总是成对出现且和为n。</p>
<hr>
<h5 id="模版题HDU-1787"><a href="#模版题HDU-1787" class="headerlink" title="模版题HDU - 1787"></a>模版题HDU - 1787</h5><p><a href="https://cn.vjudge.net/problem/HDU-1787" target="_blank" rel="noopener">题点这里</a><br>给出a，求$b&lt;a 且gcd(a,b) &gt; 1 $的个数。就是欧拉模版题，a-phi(a)-1即可。代码就不给了</p>
<h5 id="hdu3501"><a href="#hdu3501" class="headerlink" title="hdu3501"></a>hdu3501</h5><p>给一个N，求小于n里所有不与n互质的数的和。<br>这题按照上面那个套公式就行，注意/2的时候要在后面除。（先除2并不会使得原先爆精度的有所好转，反而会出现不整除的情况）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">euler</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i*i &lt;= n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">    		ans -= ans/i;</span><br><span class="line">    		<span class="keyword">while</span>(n % i == <span class="number">0</span>)</span><br><span class="line">            n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">1</span>)ans -= ans/n;</span><br><span class="line">  	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/euler/hdu3501.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%lld"</span>,&amp;n) &amp;&amp; n)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = euler(n);</span><br><span class="line"><span class="comment">//        long long ans;</span></span><br><span class="line">        ans = ans * n / <span class="number">2</span>;</span><br><span class="line">        sum = (n - <span class="number">1</span>) * n / <span class="number">2</span> ;</span><br><span class="line">        ans = (sum - ans) % p;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="hdu2824"><a href="#hdu2824" class="headerlink" title="hdu2824"></a>hdu2824</h5><p>求$\sum_{i =a}^{b} phi(i)$<br>打表筛法即可，代码略</p>
<h5 id="hdu2588"><a href="#hdu2588" class="headerlink" title="hdu2588"></a>hdu2588</h5><p>对给出的n m 求$ x&lt;n且gcd(x,n) &gt;=m$的x的个数。<br>$gcd(x,n) &gt;= m $可转化成$n = p * d, x = q * d; d &gt;= m$。p与q互质且p&gt;q。则枚举p可能的值，求其欧拉函数和就是所有x可能的个数（无重复，因为d在变<br>（注意枚举d可能的值则会tle。打表会re</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">euler</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i*i &lt;= n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">    		ans -= ans/i;</span><br><span class="line">    		<span class="keyword">while</span>(n % i == <span class="number">0</span>)</span><br><span class="line">            n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(n &gt; <span class="number">1</span>)ans -= ans/n;</span><br><span class="line">  	<span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">    freopen(<span class="string">"/Users/ecooodt/Desktop/c++ and acm/special--专题/1-数论/euler/hdu2588.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;T);</span><br><span class="line"><span class="comment">//    getEuler();</span></span><br><span class="line">    <span class="keyword">while</span>(T--)</span><br><span class="line">    &#123;</span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</span><br><span class="line">        <span class="keyword">int</span> t = n / m;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= t; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> d;</span><br><span class="line">            <span class="keyword">if</span>(n % i == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                d = n / i;</span><br><span class="line">                <span class="keyword">if</span>(d &gt;= m)</span><br><span class="line">                ans += euler(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="spoj-starsbc"><a href="#spoj-starsbc" class="headerlink" title="spoj-starsbc"></a>spoj-starsbc</h5><p>因为上述的gcd成对出现，故为phi(n)/2.注意euler循环里的i为longlong即可，代码略。</p>
<hr>
<p>ok本篇到这里。其实关于欧拉、gcd的题还有一些，还有大数分解可能也是这块的，下次写啦。集训应该会讲的。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/special/" rel="tag"># special</a>
          
            <a href="/tags/n-t/" rel="tag"># n-t</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/07/09/test-for-mac/" rel="next" title="test_for_mac">
                <i class="fa fa-chevron-left"></i> test_for_mac
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/07/19/acm/%E4%B8%93%E9%A2%98/%E5%AD%97%E7%AC%A6%E4%B8%B2/kmp/" rel="prev" title="kmp">
                kmp <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/07/13/acm/专题/快速幂及数论相关/"
           data-title="快速幂及数论相关" data-url="http://oodtoodt.github.io/2017/07/13/acm/%E4%B8%93%E9%A2%98/%E5%BF%AB%E9%80%9F%E5%B9%82%E5%8F%8A%E6%95%B0%E8%AE%BA%E7%9B%B8%E5%85%B3/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/prpr.jpg"
               alt="eco_oodt" />
          <p class="site-author-name" itemprop="name">eco_oodt</p>
           
              <p class="site-description motion-element" itemprop="description">---自虐一点 开心一点</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">82</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">31</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#快速幂"><span class="nav-number">1.</span> <span class="nav-text">快速幂</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#组合数取模。"><span class="nav-number">1.1.</span> <span class="nav-text">组合数取模。</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#lucas："><span class="nav-number">1.1.1.</span> <span class="nav-text">lucas：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#欧几里得gcd，每次都能忘的东西："><span class="nav-number">1.2.</span> <span class="nav-text">欧几里得gcd，每次都能忘的东西：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#扩展欧几里得算法（数学爆炸，一点都不想看）自己看去吧"><span class="nav-number">1.3.</span> <span class="nav-text">扩展欧几里得算法（数学爆炸，一点都不想看）自己看去吧</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#模版题-hdu2669"><span class="nav-number">1.3.1.</span> <span class="nav-text">模版题 hdu2669</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#poj1061"><span class="nav-number">1.3.2.</span> <span class="nav-text">poj1061</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu1576"><span class="nav-number">1.3.3.</span> <span class="nav-text">hdu1576</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#poj2142"><span class="nav-number">1.3.4.</span> <span class="nav-text">poj2142</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu1576、poj2115、poj2142、"><span class="nav-number">1.3.5.</span> <span class="nav-text">hdu1576、poj2115、poj2142、</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu1211"><span class="nav-number">1.3.6.</span> <span class="nav-text">hdu1211</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu5407"><span class="nav-number">1.3.7.</span> <span class="nav-text">hdu5407</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cf-300c"><span class="nav-number">1.3.8.</span> <span class="nav-text">cf 300c</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#组合数取模。-1"><span class="nav-number">1.4.</span> <span class="nav-text">组合数取模。</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#cf300c"><span class="nav-number">1.4.1.</span> <span class="nav-text">cf300c</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cf327c"><span class="nav-number">1.4.2.</span> <span class="nav-text">cf327c</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#欧拉函数"><span class="nav-number">1.5.</span> <span class="nav-text">欧拉函数:</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#模版题HDU-1787"><span class="nav-number">1.5.1.</span> <span class="nav-text">模版题HDU - 1787</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu3501"><span class="nav-number">1.5.2.</span> <span class="nav-text">hdu3501</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu2824"><span class="nav-number">1.5.3.</span> <span class="nav-text">hdu2824</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdu2588"><span class="nav-number">1.5.4.</span> <span class="nav-text">hdu2588</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#spoj-starsbc"><span class="nav-number">1.5.5.</span> <span class="nav-text">spoj-starsbc</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">eco_oodt</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next" target="_blank" rel="noopener">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"oodtoodtgithub"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  














  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("9nyYGut00EwMsBkAM79MHdVT-gzGzoHsz", "S2d0pfqMODa7ipkySemFGTdl");AV.useAVCloudUS();</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
